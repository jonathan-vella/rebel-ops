#!/bin/sh

# Commit message validation hook
# Enforces Conventional Commits format for semantic versioning automation

echo "ğŸ” Validating commit message format..."

# Run commitlint on the commit message
npx --no -- commitlint --edit "$1"

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Commit message validation failed!"
  echo ""
  echo "ğŸ“– Conventional Commits format required:"
  echo "   <type>[optional scope]: <description>"
  echo ""
  echo "   Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
  echo ""
  echo "   Examples:"
  echo "     feat: add new diagram generator agent"
  echo "     fix(bicep): correct resource naming"
  echo "     docs: update quickstart guide"
  echo "     feat!: redesign agent workflow (BREAKING CHANGE)"
  echo ""
  echo "   Version bump rules:"
  echo "     â€¢ feat:  â†’ minor version bump (e.g., 1.0.0 â†’ 1.1.0)"
  echo "     â€¢ fix:   â†’ patch version bump (e.g., 1.0.0 â†’ 1.0.1)"
  echo "     â€¢ feat!: â†’ major version bump (e.g., 1.0.0 â†’ 2.0.0)"
  echo "     â€¢ docs:, chore:, etc. â†’ no version bump"
  echo ""
  echo "ğŸ“š Learn more: https://www.conventionalcommits.org/"
  exit 1
fi

echo "âœ… Commit message format valid"
