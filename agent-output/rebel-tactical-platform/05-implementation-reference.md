# Step 5: Implementation Reference - Rebel Tactical Platform

> Generated by bicep-implement agent | 2026-01-20

## Bicep Templates Location

üìÅ **Code Location**: [`infra/bicep/rebel-tactical/`](../../infra/bicep/rebel-tactical/)

## File Structure

```
infra/bicep/rebel-tactical/
‚îú‚îÄ‚îÄ main.bicep              # Main orchestration template (188 lines)
‚îú‚îÄ‚îÄ main.bicepparam         # Parameter file
‚îú‚îÄ‚îÄ deploy.ps1              # PowerShell deployment script with WhatIf support
‚îú‚îÄ‚îÄ README.md               # Deployment documentation
‚îî‚îÄ‚îÄ modules/
    ‚îú‚îÄ‚îÄ log-analytics.bicep     # Log Analytics Workspace module
    ‚îú‚îÄ‚îÄ app-insights.bicep      # Application Insights module
    ‚îî‚îÄ‚îÄ static-web-app.bicep    # Azure Static Web Apps module
```

## Validation Status

| Check         | Status  | Notes               |
| ------------- | ------- | ------------------- |
| `bicep build` | ‚úÖ Pass | No build errors     |
| `bicep lint`  | ‚úÖ Pass | No linting warnings |
| Deployment    | ‚úÖ Pass | Deployed 2026-01-20 |

## Resources Created

| Resource                | Bicep Type                                         | Module                       | Status      |
| ----------------------- | -------------------------------------------------- | ---------------------------- | ----------- |
| Resource Group          | Microsoft.Resources/resourceGroups                 | main.bicep                   | ‚úÖ Deployed |
| Log Analytics Workspace | Microsoft.OperationalInsights/workspaces           | modules/log-analytics.bicep  | ‚úÖ Deployed |
| Application Insights    | Microsoft.Insights/components                      | modules/app-insights.bicep   | ‚úÖ Deployed |
| Static Web App          | Microsoft.Web/staticSites                          | modules/static-web-app.bicep | ‚úÖ Deployed |
| Smart Detector Alert    | Microsoft.AlertsManagement/smartDetectorAlertRules | Auto-created                 | ‚úÖ Deployed |

## Deployment Instructions

### Quick Deploy

```powershell
cd infra/bicep/rebel-tactical
./deploy.ps1
```

### Preview Changes (What-If)

```powershell
./deploy.ps1 -WhatIf
```

### Custom Parameters

```powershell
./deploy.ps1 `
    -ResourceGroupName "rg-rebel-tactical-prod-weu" `
    -Location "westeurope" `
    -Environment "prod"
```

## Key Implementation Notes

### Unique Resource Naming

All resources use the `uniqueString()` function to ensure globally unique names:

```bicep
// main.bicep
var uniqueSuffix = uniqueString(resourceGroup().id)
var logAnalyticsName = 'log-${projectName}-${environment}-${region}'
var appInsightsName = 'appi-${projectName}-${environment}-${region}'
var staticWebAppName = 'stapp-${projectName}-${environment}-${region}'
```

### Mandatory Tags

All resources include 9 mandatory tags enforced by Azure Policy:

```bicep
tags: {
  Environment: environment
  Project: projectName
  Owner: owner
  ManagedBy: 'Bicep'
  CostCenter: costCenter
  BusinessUnit: businessUnit
  DataClassification: 'Internal'
  Criticality: 'Medium'
  Compliance: 'None'
}
```

### Subscription-Scoped Deployment

The main template deploys at subscription scope to create the resource group:

```bicep
targetScope = 'subscription'

resource rg 'Microsoft.Resources/resourceGroups@2021-04-01' = {
  name: resourceGroupName
  location: location
  tags: commonTags
}
```

### Module References

All resource modules are referenced with proper scope:

```bicep
module logAnalytics 'modules/log-analytics.bicep' = {
  scope: rg
  name: 'log-analytics-deployment'
  params: {
    name: logAnalyticsName
    location: location
    tags: commonTags
  }
}
```

### Security Baseline

All resources implement Azure Well-Architected Framework security baseline:

- **Application Insights**: Workspace-based mode (centralized security)
- **Log Analytics**: 30-day retention, 1GB daily quota
- **Static Web App**: HTTPS only, managed Functions integration
- **Managed Identities**: Used where applicable (planned for future services)

### Regional Configuration

| Setting         | Value                        | Rationale                                |
| --------------- | ---------------------------- | ---------------------------------------- |
| Primary Region  | West Europe (`westeurope`)   | GDPR compliance, EU data residency       |
| Resource Group  | `rg-rebel-tactical-prod-weu` | CAF naming convention                    |
| Failover Region | Not configured               | Single-region deployment (demo workload) |

### Dependencies

The deployment follows this dependency chain:

```
1. Resource Group
   ‚îî‚îÄ‚îÄ 2. Log Analytics Workspace
       ‚îî‚îÄ‚îÄ 3. Application Insights (workspace-based)
           ‚îî‚îÄ‚îÄ 4. Static Web App (with App Insights key)
```

### CI/CD Integration

The Bicep templates are deployed via GitHub Actions:

- **Repository**: jonathan-vella/rebel-ops
- **Workflow**: `.github/workflows/deploy.yml` (if exists)
- **Trigger**: Manual or on push to `main` branch
- **Deployment Method**: PowerShell script (`deploy.ps1`)

### Cost Optimization

Resources configured for cost efficiency:

| Resource             | Cost Optimization                      | Monthly Cost |
| -------------------- | -------------------------------------- | ------------ |
| Static Web App       | Standard tier (no Enterprise features) | $9.00        |
| Application Insights | Using free 5GB/month tier              | $5.44        |
| Log Analytics        | 30-day retention (vs 90+ days)         | $2.86        |
| **Total**            |                                        | **$17.24**   |

### Validation & Testing

Pre-deployment validation checklist:

- [x] Bicep build successful
- [x] Bicep lint passed
- [x] Parameter file syntax valid
- [x] Resource naming conventions followed
- [x] Mandatory tags included
- [x] Security baseline implemented
- [x] Regional requirements met

### Post-Deployment Verification

After deployment, verify:

```powershell
# Check resource group
az group show --name rg-rebel-tactical-prod-weu

# Check deployed resources
az resource list --resource-group rg-rebel-tactical-prod-weu --output table

# Check Static Web App status
az staticwebapp show --name stapp-rebel-tactical-prod-weu

# Check Application Insights
az monitor app-insights component show --app appi-rebel-tactical-prod-weu --resource-group rg-rebel-tactical-prod-weu
```

### Troubleshooting

Common issues and resolutions:

| Issue                             | Resolution                                     |
| --------------------------------- | ---------------------------------------------- |
| Resource name already exists      | Bicep uses `uniqueString()` - should not occur |
| Deployment timeout                | Increase timeout in deploy.ps1                 |
| Module not found                  | Verify relative path to `modules/` directory   |
| Permission denied                 | Ensure Contributor role on subscription        |
| Smart Detector in "Failure" state | Expected for new deployments, auto-resolves    |

---

## Related Documentation

- **Implementation Plan**: [04-implementation-plan.md](./04-implementation-plan.md)
- **Deployment Summary**: [06-deployment-summary.md](./06-deployment-summary.md)
- **Resource Inventory**: [07-resource-inventory.md](./07-resource-inventory.md)
- **Bicep Patterns Reference**: [`docs/reference/bicep-patterns.md`](../../docs/reference/bicep-patterns.md)

---

_Implementation reference generated from deployed Bicep templates. For deployment instructions, see [deploy.ps1](../../infra/bicep/rebel-tactical/deploy.ps1)._
